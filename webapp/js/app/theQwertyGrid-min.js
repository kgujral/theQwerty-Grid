var theQwerty=function(e){function c(t){t.data=t.data||[];t.displayData=t.displayData||"";t.errorMessage=t.errorMessage||THE_QWERTY_DEFAULTS.text.errorMessage;t.loadingImage=t.loadingImage||"undefined";t.wrapperId=typeof t.wrapperId==="undefined"?"body":"#"+t.wrapperId;t.tableId=typeof t.tableId==="undefined"?"table-id":t.tableId;t.pageSize=typeof t.pageSize==="undefined"?[10,20,30]:t.pageSize;t.style=typeof t.style==="undefined"?"":t.style;var c=0;for(var h=0;h<t.cols.length;h++){t.cols[h].sortable=typeof t.cols[h].sortable==="undefined"?false:t.cols[h].sortable;t.cols[h].hide=typeof t.cols[h].hide==="undefined"?false:t.cols[h].hide;t.cols[h].PK=typeof t.cols[h].PK==="undefined"?false:t.cols[h].PK;if(t.cols[h].PK==true){f[c++]=h}t.cols[h].type=typeof t.cols[h].type==="undefined"||t.cols[h].type!="string"&&t.cols[h].type!="int"?"string":t.cols[h].type;t.cols[h].displayAs=typeof t.cols[h].displayAs==="undefined"?"normal":t.cols[h].displayAs;t.cols[h].values=typeof t.cols[h].values==="undefined"?[]:t.cols[h].values;t.cols[h].displayValues=typeof t.cols[h].displayValues==="undefined"?t.cols[h].values:t.cols[h].displayValues;t.cols[h].transformer=typeof t.cols[h].transformer==="undefined"?F:t.cols[h].transformer;t.cols[h].cssClass=typeof t.cols[h].cssClass==="undefined"?"":t.cols[h].cssClass;t.cols[h].width=typeof t.cols[h].width==="undefined"?"auto":t.cols[h].width}t.controls=typeof t.controls==="undefined"?[]:t.controls;for(var h=0;h<t.controls.length;h++){t.controls[h].type=typeof t.controls[h].type==="undefined"?"button":t.controls[h].type;t.controls[h].caption=typeof t.controls[h].caption==="undefined"?"":t.controls[h].caption;t.controls[h].cssClass=typeof t.controls[h].cssClass==="undefined"?"":t.controls[h].cssClass;t.controls[h].headerCaption=typeof t.controls[h].headerCaption==="undefined"?t.controls[h].caption:t.controls[h].headerCaption;t.controls[h].title=typeof t.controls[h].title==="undefined"?t.controls[h].caption:t.controls[h].title;t.controls[h].displayPredicate=typeof t.controls[h].displayPredicate==="undefined"?j:t.controls[h].displayPredicate;t.controls[h].predicateProperty=typeof t.controls[h].predicateProperty==="undefined"?t.cols[0].name:t.controls[h].predicateProperty}t.paging=typeof t.paging==="undefined"?[]:t.paging;t.paging.enable=typeof t.paging.enable==="undefined"?false:t.paging.enable;t.paging.remote=typeof t.paging.remote==="undefined"?false:t.paging.remote;t.paging.totalRecords=typeof t.paging.totalRecords==="undefined"?t.data.length:t.paging.totalRecords;t.url=typeof t.url==="undefined"?"":t.url;t.successCallback=typeof t.successCallback==="undefined"?j:t.successCallback;e(t.wrapperId).hide();l=t;n=0;i=t.pageSize[0];r=n+i;s=t.data;o=s;u=t.cols;a=true;THE_QWERTY_DEFAULTS.id.pagingPrev=l.tableId+"-prev-link";THE_QWERTY_DEFAULTS.id.pagingNext=l.tableId+"-next-link";THE_QWERTY_DEFAULTS.cssClass.pagingPrevSys=l.tableId+"-prev";THE_QWERTY_DEFAULTS.cssClass.pagingPrevDisabledSys=l.tableId+"-prev-disabled";THE_QWERTY_DEFAULTS.cssClass.pagingNextSys=l.tableId+"-next";THE_QWERTY_DEFAULTS.cssClass.pagingNextDisabledSys=l.tableId+"-next-disabled";THE_QWERTY_DEFAULTS.cssClass.pagingFirstDisabledSys=l.tableId+"-first-disabled";THE_QWERTY_DEFAULTS.cssClass.pagingLastDisabledSys=l.tableId+"-last-disabled";if(t.paging.totalRecords<=0){I(t.errorMessage)}else{d(t);C()}}function h(t){var n=e("<thead>");var r=e("<tr>");r.addClass(THE_QWERTY_DEFAULTS.cssClass.theadTr);for(var i=0;i<t.headerCols.length;i++){var s=e("<th>");s.addClass(THE_QWERTY_DEFAULTS.cssClass.theadTrTh);var o=typeof t.cols[i]==="undefined"?"auto":t.cols[i].width;s.attr("width",o);if(!typeof t.cols[i]==="undefined"&&t.cols[i].sortable){var u="";if(t.cols[i].type=="string"){u="theQwertyGrid_sortString"}else if(t.cols[i].type=="int"){u="theQwertyGrid_sortInt"}r.append(s.append('<a onclick="'+u+"('"+t.cols[i].name+"')\">"+t.headerCols[i]+"</a>"))}else if(typeof t.cols[i]!="undefined"&&!t.cols[i].hide){r.append(s.append(t.headerCols[i]))}else if(typeof t.cols[i]==="undefined"){r.append(s.append(t.headerCols[i]))}}n.append(r);return n}function p(e){if(e.paging.enable){E(false,e.pageSize[0])}}function d(n){var r=e("<tbody>");r.attr("id",n.tableId+"_rows");t=e("<table>");t.addClass(THE_QWERTY_DEFAULTS.cssClass.table);t.attr("id",n.tableId);t.attr("style","display: none;");var i=h(n);p(n);t.append(i);t.append(r);e(n.wrapperId).append(t);v(o,n)}function v(t,n){var r=e("#"+n.tableId+"_rows");for(var i=0;i<t.length;i++){PKVals=m(t[i]);var s=e("<tr>").attr("id",n.tableId+"_row"+i);var o=e("<td>");if(i%2==0)s.attr("class",THE_QWERTY_DEFAULTS.cssClass.tbodyTrOdd);else s.attr("class",THE_QWERTY_DEFAULTS.cssClass.tbodyTrEven);for(var a=0;a<u.length;a++){if(!u[a].hide){var f=g(u[a],t[i],i);s.append(f)}}for(var a=0;a<n.controls.length;a++){w(o,n.controls[a],t[i])}if(n.controls.length){s.append(o)}r.append(s)}if(t.length>0){n.successCallback()}}function m(e){var t="";for(var n=0;n<f.length;n++){t+=", '"+e[u[f[n]].name]+"'"}t=t.substring(2);return t}function g(t,n,r){var i=e("<td>");if(t.displayAs=="normal"){i.html(t.transformer(n[t.name]))}else if(t.displayAs=="select"){i=y(t,n,r)}else if(t.displayAs=="template"){i=b(t,n)}return i}function y(t,n,r){var i=e("<td>");var s=m(n);var o=l.tableId+"-"+t.name+"-select-"+r;var u=n[t.name];var a="";if(typeof t.func!=="undefined"){a=' onchange="'+t.func+"(this,"+s+')"'}var f='<select id="'+o+'" class="'+THE_QWERTY_DEFAULTS.cssClass.controls+" "+t.cssClass+'"'+a+">";var c="";for(var h=0;h<t.values.length;h++){if(t.values[h]==u){c+='<option selected ="selected" value="'+t.values[h]+'">'+t.displayValues[h]+"</option>"}else{c+='<option value="'+t.values[h]+'">'+t.displayValues[h]+"</option>"}}f+=c+"</select>";i.html(f);return i}function b(t,n){var r=e("<td>");W(t.templateId,r,n);return r}function w(e,t,n){var r="";for(var i=0;i<t.predicateProperty.length;i++){r+=", "+n[t.predicateProperty[i]]}r=r.substring(2);var s="";if(typeof t.func!=="undefined"){s=' onclick="'+t.func+"(this,"+PKVals+')"'}if(t.displayPredicate(r)){if(t.type=="button"){e.append('<input title="'+t.title+'" class="'+THE_QWERTY_DEFAULTS.cssClass.controls+" "+t.cssClass+'" type="'+t.type+'" value="'+t.caption+'"'+s+"/>")}}}function E(e,t){if(e){n=0}i=parseInt(t);r=n+i;if(r>=l.paging.totalRecords){r=l.paging.totalRecords}if(l.paging.remote){k(n,r)}else{var u=[];for(var a=n;a<r;a++){u.push(s[a])}o=u;C();B(o)}}function S(){r=n;n=r-i<0?0:r-i;E(false,i)}function x(){n=r;r=n+i>l.paging.totalRecords?l.paging.totalRecords:n+i;E(false,i)}function T(){E(true,i)}function N(){var e=Math.ceil(l.paging.totalRecords/i);n=parseInt(e-1)*i;r=n+i>l.paging.totalRecords?l.paging.totalRecords:n+i;E(false,i)}function C(){if(n<=0){e("."+THE_QWERTY_DEFAULTS.cssClass.pagingFirst).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingFirstDisabledSys).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingPrevSys).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingPrevDisabledSys).show()}if(r<l.paging.totalRecords){e("."+THE_QWERTY_DEFAULTS.cssClass.pagingNextSys).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingNextDisabledSys).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingLast).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingLastDisabledSys).hide()}if(n>0){e("."+THE_QWERTY_DEFAULTS.cssClass.pagingFirst).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingFirstDisabledSys).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingPrevSys).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingPrevDisabledSys).hide()}if(r>=l.paging.totalRecords){e("."+THE_QWERTY_DEFAULTS.cssClass.pagingNextSys).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingNextDisabledSys).show();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingLast).hide();e("."+THE_QWERTY_DEFAULTS.cssClass.pagingLastDisabledSys).show()}}function k(t,n){q();var r=i;var s=Math.ceil(n/r);s--;e.ajax({url:l.url,dataType:"json",data:{pageNumber:s,pageSize:r},success:function(e){var t=l.displayData==""?e:e[l.displayData];R();O();o=t;l.data=t;C();B(o)}})}function L(){return Math.ceil(l.paging.totalRecords/i)}function A(){return Math.ceil(parseInt(n+1)/i)}function O(){e("#"+l.tableId+"_before").remove();e("#"+l.tableId+"_after").remove();var t=e("<div class= '"+THE_QWERTY_DEFAULTS.cssClass.pagingControls+"' id="+l.tableId+"_before>");var n=L();var r=A();var i="";i+=M("span","","display: none;",THE_QWERTY_DEFAULTS.cssClass.pagingPrev+" "+THE_QWERTY_DEFAULTS.cssClass.pagingDisabled+" "+THE_QWERTY_DEFAULTS.cssClass.pagingPrevDisabledSys,THE_QWERTY_DEFAULTS.text.previous)+M("a",THE_QWERTY_DEFAULTS.id.pagingPrev,"",THE_QWERTY_DEFAULTS.cssClass.pagingPrev+" "+THE_QWERTY_DEFAULTS.cssClass.pagingPrevSys,THE_QWERTY_DEFAULTS.text.previous)+'<span class="'+THE_QWERTY_DEFAULTS.cssClass.pagingPageNumber+'">'+r+"	of	"+n+"</span>"+M("span","","display: none;",THE_QWERTY_DEFAULTS.cssClass.pagingNext+" "+THE_QWERTY_DEFAULTS.cssClass.pagingDisabled+" "+THE_QWERTY_DEFAULTS.cssClass.pagingNextDisabledSys,THE_QWERTY_DEFAULTS.text.next)+M("a",THE_QWERTY_DEFAULTS.id.pagingNext,"",THE_QWERTY_DEFAULTS.cssClass.pagingNext+" "+THE_QWERTY_DEFAULTS.cssClass.pagingNextSys,THE_QWERTY_DEFAULTS.text.next);i+="</div>";e(t).html(i);var s=e("<div>");e(s).attr("id",l.tableId+"_after");e(s).attr("class","theQwerty-paging-controls");e(s).html(e(t).html());e("#"+l.tableId).before(t);e("#"+l.tableId).after(s);z()}function M(e,t,n,r,i){return"<"+e+" id='"+t+"' style='"+n+"' class='"+r+"'> "+i+"</"+e+">"}function _(t){var r=e(t).val();n=parseInt(r-1)*i;E(false,i)}function D(e){if(a){a=false;o.sort(function(t,n){return t[e]-n[e]})}else{a=true;o.sort(function(t,n){return n[e]-t[e]})}B(o)}function P(e){if(a){a=false;o.sort(function(t,n){return t[e]>n[e]?1:n[e]>t[e]?-1:0})}else{a=true;o.sort(function(t,n){return n[e]>t[e]?1:t[e]>n[e]?-1:0})}B(o)}function H(){e("#"+l.tableId+"_rows tr").remove()}function B(e){H();v(e,l)}function j(){return true}function F(e){return e}function I(t){var n=e('<div class = "'+THE_QWERTY_DEFAULTS.cssClass.errorMessage+'">');e(n).html(t);e(l.wrapperId).show();e(l.wrapperId).append(n)}function q(){e(l.wrapperId).show();if(l.loadingImage!="undefined"){var t=e("#"+l.loadingImage).html();var n=e("<center>");var r=e('<div id="'+l.tableId+'-loading">');e(r).html(t);e(n).append(r);e("#"+l.tableId+"_before").hide();e("#"+l.tableId+"_after").hide();e("#"+l.tableId).hide();e(l.wrapperId).append(n)}}function R(){e("#"+l.tableId).fadeIn();if(l.loadingImage!="undefined"){e("#"+l.tableId+"-loading").remove();e("#"+l.tableId+"_before").show();e("#"+l.tableId+"_after").show()}}function U(t,n,r){e("."+t).bind(n,r)}function z(){U(THE_QWERTY_DEFAULTS.cssClass.pagingPrevSys,"click",S);U(THE_QWERTY_DEFAULTS.cssClass.pagingNextSys,"click",x)}function W(t,n,r){var i=e("#"+t);var s=i.tmpl(r);n.html(s)}var t={};var n=0;var r=0;var i=0;var s=[];var o=[];var u=[];var a=true;var f=[];var l=[];this.grid=function(t){e("#"+t.tableId).remove();c(t)};this.getCurrentRows=function(){return o}}